# Springì—ì„œì˜ ì—°ê´€ê´€ê³„ ë§¤í•‘

> **ì£¼ì˜**
>
> ìŠ¤í”„ë§ì˜ ì—°ê´€ê´€ê³„ ë§¤í•‘ì€ DBì˜ ì™¸ë˜í‚¤ì™€ ë˜‘ê°™ì´ ìƒê°í•˜ë©´ ì•ˆ ëœë‹¤.
> DBì—ì„œëŠ” ì™¸ë˜í‚¤ë¼ëŠ” í•˜ë‚˜ì˜ columnì„ ê°€ì§€ê³  ì—°ê´€ê´€ê³„ë¥¼ í‘œí˜„í•˜ì§€ë§Œ, JPAì—ì„œëŠ” ê°ì²´ë¥¼ ë§¤í•‘í•˜ê¸° ë•Œë¬¸ì´ë‹¤.
>
> ğŸ‘‰ğŸ» JPAì—ì„œì˜ ì—°ê´€ê´€ê³„ ë§¤í•‘ì—ì„œ ì¤‘ìš”í•œ ê²ƒ
> - ê´€ê³„ì˜ ë°©í–¥
> - ë‹¤ì¤‘ì„± (ì¼ëŒ€ë‹¤? ë‹¤ëŒ€ì¼? ë‹¤ëŒ€ë‹¤?)
> - ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸


# ë‹¨ë°©í–¥ ì—°ê´€ê´€ê³„

## ë‹¤ëŒ€ì¼(N:1)

- ì˜ˆì‹œ : ì‚¬ëŒ - ê°€ì¡±

    - ì‚¬ëŒì€ í•˜ë‚˜ì˜ ê°€ì¡±ì—ë§Œ ì†Œì†ë  ìˆ˜ ìˆë‹¤. ğŸ‘‰ğŸ» ì‚¬ëŒê³¼ ê°€ì¡±ì€ **ë‹¤ëŒ€ì¼ ê´€ê³„**ì´ë‹¤.

<br>

ì´ ê´€ê³„ë¥¼ ê°ì²´ ì—°ê´€ê´€ê³„ì™€ í…Œì´ë¸” ì—°ê´€ê´€ê³„ë¡œ ë‚˜íƒ€ë‚´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

### 1. ê°ì²´ ì—°ê´€ê´€ê³„ - ë‹¤ëŒ€ì¼(N:1)

- ì‚¬ëŒ ê°ì²´ëŠ” Person.familyë¡œ ê°€ì¡± ê°ì²´ì™€ ì—°ê´€ê´€ê³„ë¥¼ ë§ºëŠ”ë‹¤.

- ì‚¬ëŒ ê°ì²´ì™€ ê°€ì¡± ê°ì²´ëŠ” ë‹¨ë°©í–¥ ê´€ê³„ì´ë‹¤. ì¦‰, ì‚¬ëŒì€ Person.familyë¥¼ í†µí•´ ê°€ì¡±ì„ ì•Œ ìˆ˜ ìˆì§€ë§Œ, ê°€ì¡±ì€ ì‚¬ëŒì„ ì•Œ ìˆ˜ ì—†ë‹¤.

- **`Person` í´ë˜ìŠ¤**
  ```java
  import javax.persistence.*;		// ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ ê´€ë ¨ ì„¤ì •

  @Entity
  public class Person {
  
      @Id														// í•´ë‹¹ í”„ë¡œí¼í‹°ê°€ í…Œì´ë¸”ì˜ ê¸°ë³¸í‚¤(primary key)ì—­í• ì„ í•œë‹¤ëŠ” ì˜ë¯¸
      @GeneratedValue(strategy = GenerationType.IDENTITY)		// ê¸°ë³¸í‚¤ì˜ ê°’ ìë™ ìƒì„± ì „ëµ
      private Long id;

      @Column
      private String name;
      
      @ManyToOne		// ë‹¤ëŒ€ì¼ê´€ê³„ë¼ëŠ” ë§¤í•‘ ì •ë³´(ë‹¤ëŒ€ì¼ ì—°ê´€ê´€ê³„ ë§¤í•‘ì‹œ í•„ìˆ˜ ì‚¬ìš©)
      @JoinColumn		// ì™¸ë˜í‚¤ ë§¤í•‘ì‹œ ì‚¬ìš© (name ì†ì„±ì—ëŠ” ë§¤í•‘í•  ì™¸ë˜í‚¤ ì´ë¦„ ì§€ì •(ìƒëµì‹œ ì™¸ë˜í‚¤ ë§¤í•‘ ì»¬ëŸ¼ ì´ë¦„ ìë™ ìƒì„±))
      private Family family;
  ```


- **`Family` í´ë˜ìŠ¤**
  ```java
  import javax.persistence.*;

  @Entity
  public class Family {

      @Id
      @GeneratedValue(strategy = GenerationType.IDENTITY)
      private Long id;

      @Column
      private String address;
  }
  ```

![](https://velog.velcdn.com/images/sw_smj/post/1871f986-7b32-44ba-9748-4ee742401d42/image.png)



<br>

### 2. DB í…Œì´ë¸” ì—°ê´€ê´€ê³„ - ë‹¤ëŒ€ì¼(N:1)

- ì‚¬ëŒ í…Œì´ë¸”ì€ Family_id ì™¸ë˜í‚¤ë¡œ ê°€ì¡± í…Œì´ë¸”ê³¼ ì—°ê´€ê´€ê³„ë¥¼ ë§ºëŠ”ë‹¤.

- ì‚¬ëŒ í…Œì´ë¸”ê³¼ ê°€ì¡± í…Œì´ë¸”ì€ ì–‘ë°©í–¥ ê´€ê³„ì´ë‹¤. ì¦‰, ì‚¬ëŒ í…Œì´ë¸”ì˜ Family_id ì™¸ë˜í‚¤ë¥¼ í†µí•´ ì‚¬ëŒê³¼ ê°€ì¡±ì„ joiní•  ìˆ˜ ìˆê³ , ë°˜ëŒ€ë¡œ ê°€ì¡±ê³¼ ì‚¬ëŒì„ joiní•  ìˆ˜ë„ ìˆë‹¤.

![](https://velog.velcdn.com/images/sw_smj/post/b5b1201b-a41d-48f9-b5de-22863b8096b9/image.png)


> ğŸ’¡ **ì •ë¦¬**<br>
> ì°¸ì¡°ë¥¼ í†µí•œ ì—°ê´€ê´€ê³„ì¸ **ê°ì²´ ì—°ê´€ê´€ê³„** : ë‹¨ë°©í–¥
> ë”°ë¼ì„œ JPAì—ì„œ ì–‘ë°©í–¥ ê´€ê³„ë¥¼ ë§Œë“¤ê³  ì‹¶ë‹¤ë©´ ë°˜ëŒ€ìª½ì—ë„ í•„ë“œë¥¼ ì¶”ê°€í•˜ì—¬ ì°¸ì¡°ë¥¼ í•´ì•¼ í•¨
>
> (â†” DB í…Œì´ë¸” (= ì™¸ë˜í‚¤ í•˜ë‚˜ë¡œ ì–‘ë°©í–¥ ì¡°ì¸ ê°€ëŠ¥))



<br>

# ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„

## ë‹¤ëŒ€ì¼ + ì¼ëŒ€ë‹¤ (N:1 + 1:M â‡’ N:M)

<br>

### 1. Spring ê°ì²´ ì—°ê´€ê´€ê³„ - ì¼ëŒ€ë‹¤

ìœ„ì˜ ì˜ˆì œì—ì„œëŠ” í•­ìƒ Person í´ë˜ìŠ¤ì—ì„œë§Œ Family í´ë˜ìŠ¤ì— ì ‘ê·¼í•  ìˆ˜ ìˆì—ˆë‹¤. ì´ì— ë°˜ëŒ€ë¡œ Family í´ë˜ìŠ¤ì—ì„œ Person í´ë˜ìŠ¤ë¥¼ ì ‘ê·¼í•˜ëŠ” ë°©ë²•ì„ ì¶”ê°€í•´ë³´ë„ë¡ í•œë‹¤.

ğŸ‘‰ğŸ» ì„œë¡œ ì–‘ë°©í–¥ìœ¼ë¡œ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ë¡œ ë§¤í•‘ì´ ê°€ëŠ¥í•´ì§„ë‹¤.

<br>

#### ğŸ“Œ ì¼ëŒ€ë‹¤ ì—°ê´€ê´€ê³„ë¥¼ êµ¬í˜„í•˜ë ¤ë©´?

â¡ **collection ì´ìš©!** (ex: List ë“±)

> ğŸ’¡ **ì—¬ê¸°ì„œ ì£¼ì˜!**
>
> DBì—ì„œëŠ” ì™¸ë˜í‚¤ í•˜ë‚˜ë§Œì„ ì´ìš©í•´ì„œë„ ì–‘ë°©í–¥ìœ¼ë¡œ ì¡°íšŒ ê°€ëŠ¥!
> ê·¸ëŸ¬ë‚˜ ê°ì²´ ì—°ê´€ê´€ê³„ì—ì„œëŠ” (ì£¼ë¡œ List ë“±) collectionì„ í™œìš©í•´ì•¼ í•¨!

<br>


- **`Person` í´ë˜ìŠ¤**

  ```java
  import javax.persistence.*;

   @Entity
   public class Person {

      @Id
      @GeneratedValue(strategy = GenerationType.IDENTITY)
      private Long id;

      @Column
      private String name;

      @ManyToOne
      @JoinColumn
      private Family family;
  ```


- **`Family` í´ë˜ìŠ¤** (List Collection ì‚¬ìš©)

  ```java
  import javax.persistence.*;
   import java.util.List;

   @Entity
   public class Family {

       @Id
       @GeneratedValue(strategy = GenerationType.IDENTITY)
       private Long id;
 
       @Column
       private String address;

       @OneToMany(mappedBy = "family")
       private List<Person> people;
  ```


![](https://velog.velcdn.com/images/sw_smj/post/6291a077-7987-4803-919d-2eebc00b0ef0/image.png)

> ğŸ‘‰ğŸ» **`mappedBy`ê°€ í•„ìš”í•œ ì´ìœ **
> - ì—„ë°€íˆ ë§í•˜ë©´ ê°ì²´ì—ëŠ” ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ë€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤. ì„œë¡œ ë‹¤ë¥¸ ë‹¨ë°©í–¥ ì—°ê´€ê´€ê³„ 2ê°œë¥¼ ë¬¶ì–´ì„œ ì–‘ë°©í–¥ì²˜ëŸ¼ ê¸°ëŠ¥í•˜ê²Œ í•˜ëŠ” ê²ƒ ë¿ì´ë‹¤ (â†” DB í…Œì´ë¸” : ì™¸ë˜í‚¤ í•˜ë‚˜ë¡œ joiní•´ì„œ ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ë¥¼ ë§ºìŒ)
    > Entityë¥¼ ì–‘ë°©í–¥ìœ¼ë¡œ ë§¤í•‘í•˜ë©´, ë‘ ê³³ì—ì„œ ì„œë¡œë¥¼ ì°¸ì¡°í•˜ê²Œ ë˜ê¸° ë•Œë¬¸ì— ê°ì²´ì˜ ì—°ê´€ê´€ê³„ë¥¼ ê´€ë¦¬í•˜ëŠ” í¬ì¸íŠ¸ê°€ 2ê³³ì´ ëœë‹¤.
    > ë”°ë¼ì„œ ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ JPAì—ì„œ ë‘ ê°ì²´ ì—°ê´€ê´€ê³„ ì¤‘ í•˜ë‚˜ë¥¼ ì •í•´ì„œ í…Œì´ë¸”ì˜ ì™¸ë˜í‚¤ë¥¼ ê´€ë¦¬í•´ì•¼ í•œë‹¤. â¡ ì´ë¥¼ **ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸**ì´ë¼ê³  í•œë‹¤. 

<br>

> ğŸ‘‰ğŸ» **ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸**
> - ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ë§Œì´ DB ì—°ê´€ê´€ê³„ì™€ ë§¤í•‘ë˜ë©°, ì™¸ë˜í‚¤ë¥¼ ê´€ë¦¬(ë“±ë¡, ìˆ˜ì •, ì‚­ì œ)í•  ìˆ˜ ìˆë‹¤. ì£¼ì¸ì´ ì•„ë‹Œ ìª½ì€ ì½ê¸°ë§Œ í•  ìˆ˜ ìˆë‹¤.
> - ì£¼ì¸ì€ mappedBy ì†ì„±ì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.
> - ì£¼ì¸ì´ ì•„ë‹ˆë©´, mappedBy ì†ì„±ì„ ì‚¬ìš©í•˜ì—¬ ì†ì„±ì˜ ê°’ìœ¼ë¡œ ì—°ê´€ê´€ê¼ì˜ ì£¼ì¸ì„ ì§€ì •í•´ì•¼ í•œë‹¤.


<br><br><BR>

---

**ì°¸ê³ ìë£Œ**

- https://hyeooona825.tistory.com/88